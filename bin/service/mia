#! /bin/bash

. /etc/init.d/functions

pidfile="/home/karotz/mia/mia.pid"

start() {
  echo -n $"Starting Sinatra Mia: "	
  su karotz -c "cd /home/karotz/mia/current;GEM_HOME=/home/karotz/.gem nohup /usr/local/bin/ruby lib/server.rb >/home/karotz/mia/server.log 2>&1 &"
  RETVAL=$?
  echo
  return $RETVAL
}

stop() {
  echo -n $"Stopping Sinatra Mia: "
  killproc "ruby"
  RETVAL=$?
  echo
  return $RETVAL
}	

restart() {
  stop
  start
}	

case "$1" in
  start)
    start
    ;;
  stop)
    stop
    ;;
  restart)
    restart
    ;;
  *)
    echo $"Usage: $0 {start|stop|restart}"
    exit 1
esac
